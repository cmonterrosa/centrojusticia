
<%if current_user.has_role?("invitadores")%>
  <%=link_to "Invitaciones sin entregar", :action => "list_by_user"%> | <%=link_to "Invitaciones entregadas", :action => "show_entregadas_by_user"%><br /><br/>
<%end%>

<%if @invitaciones%>
<table class="table1" width="85%">
    <thead>
         <!-- Titulos -->
         <tr>
            <th>&nbsp;</th>
            <th>Número de expediente</th>
            <th scope="col" abbr="Starter">Participante</th>
            <th scope="col" abbr="Starter">Fecha de sesión</th>
            <th scope="col" abbr="Starter">Cuadrante</th>
            <th scope="col" abbr="Starter" colspan="4">Acciones</th>
         </tr>
    </thead>

    <tbody>
        <%@invitaciones.each do |invitacion|%>
          <tr>
            <td><%=h (invitacion.entregada)? (image_tag "iconos/true.png", :border =>0): "-"%></td>
            <td><%=h (invitacion.tramite) ? (link_to "#{invitacion.tramite.numero_expediente}", :action => "show", :controller => "tramites", :id => invitacion.tramite.id, :target => "_blank") : ""%></td>
            <td><%=h (invitacion.participante) ? invitacion.participante.nombre_completo : "----"%></td>
            <td><%=h (invitacion.sesion.start_at)? invitacion.sesion.start_at.strftime("%d de %B de %Y / %H:%M") : "---"%></td>
            <!--
            <td><= (invitacion.fecha_hora_entrega)? (invitacion.fecha_hora_entrega.strftime("%d de %B de %Y / %H:%M")) : "---"%></td>
            -->
            <td><%=h (invitacion.cuadrante) ? (invitacion.cuadrante) : "N/A"%></td>
             <%if invitacion.signed?%>
            <td><%=link_to 'Imprimir', {:action => "generar", :id => invitacion.id, :p => invitacion.participante_id, :token => "h9jqwo8h7s" }, :title => "Imprimir invitaciones de trámite", :class => 'boton'%></td>
            <%unless invitacion.fecha_hora_entrega%>
                
                <!-- Si es director podra entregarlas personalmente -->
                <%if current_user.has_role?("direccion")%>
                    <td><%=link_to 'Se entrego personalmente',{:action => "notificar_entrega_personal", :id => invitacion, :p => invitacion.participante_id}, :title => "Notificar entrega personal", :class => 'boton'%></td>
                <%else%>
                    <td><%=link_to 'Razonar',{:action => "razonar", :id => invitacion, :p => invitacion.participante_id}, :title => "Razonar invitación", :class => 'boton'%></td>
                <%end%>


              <%end%>
            <%else%>
              <td><%=link_to 'No se puede imprimir por falta de firma', :title => "Imprimir invitacion de trámite #{invitacion.sesion.tramite.folio_integrado}", :class => 'boton'%></td>
            <%end%>
          <!-- detalle -->
          <td><%=link_to 'Detalle', {:action => "show", :id => invitacion}, :title => "Detalle de invitación", :class => 'boton'%></td>
          </tr>
        <%end%>
    </tbody>
</table>

<%else%>
  <h3> No existe información</h3><br />
<%end%>